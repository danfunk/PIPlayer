define(["require","models/model","app/media/media_constructor","utils/pubsub","underscore","utils/is_touch","app/task/settings"],function(t){var i=t("models/model"),a=t("app/media/media_constructor"),e=t("utils/pubsub"),s=t("underscore"),u=t("utils/is_touch"),n=t("app/task/settings"),r=i.extend({initialize:function(){this.collection.trial&&(this.trial=this.collection.trial),this.attributes.data=this.attributes.data||{},this.attributes.data.handle=this.attributes.data.handle||this.attributes.handle,this.handle=this.attributes.data.handle;var t=this.get(u&&this.get("touchMedia")?"touchMedia":"media");this.media=new a(t,this)},defaults:{size:{height:"auto",width:"auto"},css:{}},activate:function(){var t=this,i=this.handle;this.timeStack=this.timeStack||[],this.pubsubStack=this.pubsubStack||[],e.subscribe("stim:start",t.pubsubStack,function(a){return s.include([i,"All"],a)?void t.media.show():!1}),e.subscribe("stim:setAttr",t.pubsubStack,function(a,e){if(!s.include([i,"All"],a))return!1;if(s.isFunction(e))e.apply(t);else{var u=t.get("data")||{};u=s.extend(u,e),t.set("data",u)}}),e.subscribe("stim:stop",t.pubsubStack,function(a){return s.include([i,"All"],a)?void t.media.hide():!1})},disable:function(){this.media.hide(),this.timeStack=this.timeStack||[],this.pubsubStack=this.pubsubStack||[],s.each(this.pubsubStack,function(t){e.unsubscribe(t)}),this.timeStack=[],this.pubsubStack=[]},name:function(){var t=this.attributes;return t.data.alias?t.data.alias:t.inherit&&t.inherit.set?t.inherit.set:t.handle?t.handle:!1},mediaName:function(){var t=this.media.options.source,i=n.logger&&n.logger.fullpath;if(t.alias)return t.alias;for(var a in t)if("inherit"!=a)return s.contains(["image","template"],a)&&!i?t[a].replace(/^.*[\\\/]/,""):t[a]}});return r});
//# sourceMappingURL=stimulus_model.js.map